---

title: Core API


keywords: fastai
sidebar: home_sidebar

summary: "Details of the `GhApi` API"
description: "Details of the `GhApi` API"
nb_path: "00_core.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mk_sig" class="doc_header"><code>mk_sig</code><a href="https://github.com/fastai/ghapi/tree/master/ghapi/core.py#L23" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mk_sig</code>(<strong><code>req_args</code></strong>, <strong><code>def_args</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="GhVerb" class="doc_header"><code>class</code> <code>GhVerb</code><a href="https://github.com/fastai/ghapi/tree/master/ghapi/core.py#L29" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>GhVerb</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="GhApi" class="doc_header"><code>class</code> <code>GhApi</code><a href="https://github.com/fastai/ghapi/tree/master/ghapi/core.py#L66" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>GhApi</code>(<strong><code>owner</code></strong>=<em><code>None</code></em>, <strong><code>repo</code></strong>=<em><code>None</code></em>, <strong><code>token</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Operation-groups">Operation groups<a class="anchor-link" href="#Operation-groups"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">api</span> <span class="o">=</span> <span class="n">GhApi</span><span class="p">(</span><span class="s1">&#39;fastai&#39;</span><span class="p">,</span> <span class="s1">&#39;ghapi-test&#39;</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="n">github_token</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following groups of endpoints are provided, which you can list at any time along with a link to documentation for all endpoints in that group, by displaying the <a href="/ghapi/core.html#GhApi"><code>GhApi</code></a> object:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">api</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea output_execute_result">
<ul>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/apps">apps</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/oauth-authorizations">oauth-authorizations</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/codes-of-conduct">codes-of-conduct</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/emojis">emojis</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/enterprise-admin">enterprise-admin</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/billing">billing</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/activity">activity</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/gists">gists</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/gitignore">gitignore</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/issues">issues</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/licenses">licenses</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/markdown">markdown</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/meta">meta</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/orgs">orgs</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/actions">actions</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/interactions">interactions</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/migrations">migrations</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/projects">projects</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/repos">repos</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/teams">teams</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/reactions">reactions</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/rate-limit">rate-limit</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/checks">checks</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/code-scanning">code-scanning</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/git">git</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/pulls">pulls</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/scim">scim</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/search">search</a></li>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/users">users</a></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Calling-endpoints">Calling endpoints<a class="anchor-link" href="#Calling-endpoints"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The GitHub API's endpoint names generally start with a verb like "get", "list", "delete", "create", etc, followed <code>_</code>, then by a noun such as "ref", "webhook", "issue", etc. Each endpoint has a different signature, which you can see by using <kbd>Shift</kbd>-<kbd>Tab</kbd> in Jupyter, or just viewing the endpoint object, which also provides a link to the official GitHub documentation:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">api</span><span class="o">.</span><span class="n">git</span><span class="o">.</span><span class="n">get_ref</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea output_execute_result">
<p><a href="https://docs.github.com/rest/reference/git#get-a-reference">git/get_ref</a>(ref): <em>Get a reference</em></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>They are called using standard Python method syntax:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ref</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">git</span><span class="o">.</span><span class="n">get_ref</span><span class="p">(</span><span class="s1">&#39;heads/master&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ref</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="s1">&#39;commit&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Information about the endpoint are available as attributes:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">api</span><span class="o">.</span><span class="n">git</span><span class="o">.</span><span class="n">get_ref</span><span class="o">.</span><span class="n">path</span><span class="p">,</span><span class="n">api</span><span class="o">.</span><span class="n">git</span><span class="o">.</span><span class="n">get_ref</span><span class="o">.</span><span class="n">verb</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&#39;/repos/fastai/ghapi-test/git/ref/{ref}&#39;, &#39;get&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can get a list of all endpoints available in a group, along with a link to documentation for each, by viewing the group:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">api</span><span class="o">.</span><span class="n">git</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">~/anaconda3/lib/python3.7/site-packages/IPython/core/formatters.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, obj)</span>
<span class="ansi-green-intense-fg ansi-bold">    343</span>             method <span class="ansi-blue-fg">=</span> get_real_method<span class="ansi-blue-fg">(</span>obj<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>print_method<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    344</span>             <span class="ansi-green-fg">if</span> method <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 345</span><span class="ansi-red-fg">                 </span><span class="ansi-green-fg">return</span> method<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    346</span>             <span class="ansi-green-fg">return</span> <span class="ansi-green-fg">None</span>
<span class="ansi-green-intense-fg ansi-bold">    347</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">&lt;ipython-input-5-f3a303c27d67&gt;</span> in <span class="ansi-cyan-fg">_repr_markdown_</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">     31</span>     <span class="ansi-green-fg">def</span> __init__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> verbs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     32</span>         <span class="ansi-green-fg">for</span> o <span class="ansi-green-fg">in</span> verbs<span class="ansi-blue-fg">:</span> setattr<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> o<span class="ansi-blue-fg">.</span>name<span class="ansi-blue-fg">,</span> o<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 33</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">def</span> _repr_markdown_<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">&#34;\n&#34;</span><span class="ansi-blue-fg">.</span>join<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;- [{k}]({_DOC_URL}{v.url})&#39;</span> <span class="ansi-green-fg">for</span> k<span class="ansi-blue-fg">,</span>v <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>items<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">AttributeError</span>: &#39;_GhVerbGroup&#39; object has no attribute &#39;items&#39;</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;__main__._GhVerbGroup at 0x7fd95080ea90&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For "list" endpoints, the noun will be a plural form, e.g.:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hooks</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">repos</span><span class="o">.</span><span class="n">list_webhooks</span><span class="p">()</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hooks</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can pass dicts, lists, etc. directly, where they are required for GitHub API endpoints:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://example.com&#39;</span>
<span class="n">cfg</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;json&#39;</span><span class="p">,</span> <span class="n">secret</span><span class="o">=</span><span class="s1">&#39;XXX&#39;</span><span class="p">)</span>
<span class="n">hook</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">repos</span><span class="o">.</span><span class="n">create_webhook</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">cfg</span><span class="p">,</span> <span class="n">events</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ping&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">hook</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's confirm that our new webhook has been created:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hooks</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">repos</span><span class="o">.</span><span class="n">list_webhooks</span><span class="p">()</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hooks</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">hooks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">events</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;ping&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we can delete our new webhook:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">api</span><span class="o">.</span><span class="n">repos</span><span class="o">.</span><span class="n">delete_webhook</span><span class="p">(</span><span class="n">hooks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea output_execute_result">

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Convenience-methods">Convenience methods<a class="anchor-link" href="#Convenience-methods"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are some multi-step processes in the GitHub API that <a href="/ghapi/core.html#GhApi"><code>GhApi</code></a> provide convenient wrappers for. The methods currently available are shown below; do not hesitate to <a href="https://github.com/fastai/ghapi-test/issues">create an issue</a> or pull request if there are other processes that you'd like to see supported better.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@patch</span>
<span class="k">def</span> <span class="nf">_upload_file</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span><span class="n">GhApi</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">fn</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
    <span class="s2">&quot;Upload `fn` to endpoint `url`&quot;</span>
    <span class="n">mime</span> <span class="o">=</span> <span class="n">mimetypes</span><span class="o">.</span><span class="n">guess_type</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="s1">&#39;application/octet-stream&#39;</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">api</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span><span class="n">mime</span><span class="p">}</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">urlsend</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">query</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="n">fn</span><span class="p">},</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@patch</span>
<span class="k">def</span> <span class="nf">create_release</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span><span class="n">GhApi</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">,</span> <span class="n">branch</span><span class="o">=</span><span class="s1">&#39;master&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                   <span class="n">draft</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prerelease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="s2">&quot;Wrapper for `api.repos.create_release` which also uploads `files`&quot;</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;v&#39;</span><span class="o">+</span><span class="n">tag_name</span>
    <span class="n">rel</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">repos</span><span class="o">.</span><span class="n">create_release</span><span class="p">(</span><span class="n">tag_name</span><span class="p">,</span> <span class="n">target_commitish</span><span class="o">=</span><span class="n">branch</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">,</span>
                                   <span class="n">draft</span><span class="o">=</span><span class="n">draft</span><span class="p">,</span> <span class="n">prerelease</span><span class="o">=</span><span class="n">prerelease</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">rel</span><span class="o">.</span><span class="n">upload_url</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;{?name,label}&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">listify</span><span class="p">(</span><span class="n">files</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_upload_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rel</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Creating a release and attaching files to it is normally a multi-stage process, so <code>create_release</code> wraps this up for you. It takes the same arguments as <code>api.repos.create_release</code>, along with <code>files</code>, which can contain a single file name, or a list of file names to upload to your release:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rel</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">create_release</span><span class="p">(</span><span class="s1">&#39;0.0.1&#39;</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;README.md&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">rel</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;v0.0.1&#39;</span><span class="p">)</span>
<span class="n">rels</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">repos</span><span class="o">.</span><span class="n">list_releases</span><span class="p">()</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rels</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can check that our file has been uploaded; GitHub refers to them as "assets":</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">assets</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">repos</span><span class="o">.</span><span class="n">list_release_assets</span><span class="p">(</span><span class="n">rels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;README.md&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">assets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">content_type</span><span class="p">,</span> <span class="s1">&#39;text/markdown&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@patch</span>
<span class="k">def</span> <span class="nf">delete_release</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span><span class="n">GhApi</span><span class="p">,</span> <span class="n">release</span><span class="p">):</span>
    <span class="s2">&quot;Delete a release and its associated tag&quot;</span>
    <span class="n">ref</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;tags/</span><span class="si">{</span><span class="n">release</span><span class="o">.</span><span class="n">tag_name</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">git</span><span class="o">.</span><span class="n">list_matching_refs</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
    <span class="n">api</span><span class="o">.</span><span class="n">repos</span><span class="o">.</span><span class="n">delete_release</span><span class="p">(</span><span class="n">rel</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
    <span class="n">api</span><span class="o">.</span><span class="n">git</span><span class="o">.</span><span class="n">delete_ref</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can delete our release and confirm that it is removed:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">api</span><span class="o">.</span><span class="n">delete_release</span><span class="p">(</span><span class="n">rels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">api</span><span class="o">.</span><span class="n">repos</span><span class="o">.</span><span class="n">list_releases</span><span class="p">()),</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

